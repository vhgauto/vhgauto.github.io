{
  "hash": "7b571efe53394ee1835883afcc8c68a6",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Semana 18\"\nsubtitle: \"Figura semana 18\"\nauthor: Víctor Gauto\ndate: \"2024-05-06\"\neditor_options:\n  chunk_output_type: console\ncategories: [geom_line, geom_point, argentina]\nimage: https://raw.githubusercontent.com/vhgauto/tidytuesday/refs/heads/main/2024/s18/viz.png\nexecute:\n  eval: false\n  echo: true\ncode-fold: true\n---\n\n\n\n\n\n# Script\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# paquetes ----------------------------------------------------------------\n\nlibrary(glue)\nlibrary(ggtext)\nlibrary(showtext)\nlibrary(tidyverse)\n\n# fuente ------------------------------------------------------------------\n\n# colores\n\nc1 <- \"grey10\"\nc2 <- \"grey30\"\nc3 <- \"grey70\"\nc4 <- \"grey90\"\nc5 <- \"#96410D\"\nc6 <- \"#2B614E\"\n\n# fuente: Ubuntu\nfont_add(\n  family = \"ubuntu\", \n  regular = \"fuente/Ubuntu-Regular.ttf\",\n  bold = \"fuente/Ubuntu-Bold.ttf\",\n  italic = \"fuente/Ubuntu-Italic.ttf\")\n\n# fuente: Bebas Neue\nfont_add(\n  family = \"bebas\", \n  regular = \"fuente/BebasNeue-Regular.ttf\")\n\n# monoespacio & íconos\nfont_add(\n  family = \"jet\", \n  regular = \"fuente/JetBrainsMonoNLNerdFontMono-Regular.ttf\")\n\nshowtext_auto()\nshowtext_opts(dpi = 300)\n\n# caption\nfuente <- glue(\n  \"Datos: <span style='color:{c5};'><span style='font-family:mono;'>\",\n  \"{{<b>tidytuesdayR</b>}}</span> semana {18}. \",\n  \"Worldwide Bureaucracy Indicators, <b>World Bank</b>.</span>\")\nautor <- glue(\"<span style='color:{c5};'>**Víctor Gauto**</span>\")\nicon_twitter <- glue(\"<span style='font-family:jet;'>&#xf099;</span>\")\nicon_instagram <- glue(\"<span style='font-family:jet;'>&#xf16d;</span>\")\nicon_github <- glue(\"<span style='font-family:jet;'>&#xf09b;</span>\")\nicon_mastodon <- glue(\"<span style='font-family:jet;'>&#xf0ad1;</span>\")\nusuario <- glue(\"<span style='color:{c5};'>**vhgauto**</span>\")\nsep <- glue(\"**|**\")\n\nmi_caption <- glue(\n  \"{fuente}<br>{autor} {sep} {icon_github} {icon_twitter} {icon_instagram} \",\n  \"{icon_mastodon} {usuario}\")\n\n# datos -------------------------------------------------------------------\n\ntuesdata <- tidytuesdayR::tt_load(2024, 18)\n\nwwbi_data <- tuesdata$wwbi_data\nwwbi_series <- tuesdata$wwbi_series\n\n# me interesan las edades de empleados públicos y privados, en educación y \n# salud en Argentina\n\n# agrego las descripciones de los códigos de los indicadores y filtro por \n# Argentina\nd_arg <- wwbi_data |> \n  filter(country_code == \"ARG\") |> \n  inner_join(\n    wwbi_series,\n    by = join_by(indicator_code)\n  ) |> \n  select(año = year, valor = value, indicador = indicator_name)\n\n# edad de empleados públicos y privados\nedad_publicos <- \"Mean age of public paid employees, by\"\nedad_privados <- \"Mean age of private paid employees, by\"\n\n# profesiones\nprofesiones <- c(\"Education|Health\")\n\n# filtro por empleados públicos y privados, y por las profesiones\nd <- d_arg |> \n  filter(str_detect(indicador, glue(\"{edad_privados}|{edad_publicos}\"))) |> \n  filter(str_detect(indicador, profesiones)) |> \n  mutate(sector = if_else(\n    str_detect(indicador, \"private\"),\n    \"privado\",\n    \"público\"\n  )) |> \n  mutate(prof = str_replace(indicador, \".*\\: (.*)\", \"\\1\")) |> \n  select(-indicador) |> \n  mutate(\n    prof = if_else(\n      prof == \"Education\",\n      \"Educación\",\n      \"Salud\"\n    )\n  )\n\n# figura ------------------------------------------------------------------\n\n# íconos para empleados públicos y privados\nicon_triangulo <- glue(\"<b style='font-family:jet; color:{c5};'>&#xf0537;</b>\")\nicon_circulo <- glue(\"<b style='font-family:jet; color:{c6};'>&#xeabc;</b>\")\n\n# subtítulo\nmi_subtitle <- glue(\n  \"En <b>Argentina</b>, entre {min(d$año)} y {max(d$año)}, aumentó la <b>edad \",\n  \"promedio</b> de los empleados en<br>\",\n  \"educación y salud, siendo los trabajadores \",\n  \"<b style='color:{c5};'>públicos</b> ({icon_triangulo}) mayores que los \",\n  \"<b style='color:{c6};'>privados</b> ({icon_circulo}).\"\n)\n\n# título eje vertical\neje_y <- \"Edad <b style='font-family:jet;'>&#xf178; &#xf178; &#xf178;</b>\"\n\n# figura\ng <- ggplot(d, aes(año, valor, shape = sector, color = sector)) +\n  # tendencias\n  geom_line(\n    stat = \"smooth\", method = lm, formula = y ~ x, linewidth = 2,\n    lineend = \"round\", alpha = .4) +\n  geom_line(\n    stat = \"smooth\", method = lm, formula = y ~ x, linewidth = .5,\n    lineend = \"square\", color = c4) +\n  # puntos\n  geom_point(size = 2, alpha = 1) +\n  geom_point(size = .5, alpha = 1, color = c4) +\n  facet_wrap(vars(prof), nrow = 1, scales = \"free\") +\n  scale_x_continuous(\n    limits = c(2000, 2017), expand = c(0, 0), breaks = scales::breaks_width(5),\n    minor_breaks = 2000:2017) +\n  scale_y_continuous(\n    limits = c(37, 45), expand = c(0, 0), breaks = scales::breaks_width(1)) +\n  scale_color_manual(\n    values = c(c6, c5)) +\n  coord_cartesian(clip = \"off\") +\n  labs(x = NULL, y = eje_y, subtitle = mi_subtitle, caption = mi_caption) +\n  theme_void() +\n  theme(\n    aspect.ratio = 1,\n    plot.margin = margin(l = 20, r = 20, b = 10, t = 15.3),\n    plot.background = element_rect(fill = c4, linewidth = 3, color = c3),\n    plot.subtitle = element_markdown(\n      color = c1, family = \"ubuntu\", size = 13, lineheight = unit(1.1, \"line\"),\n      margin = margin(b = 18)),\n    plot.caption = element_markdown(\n      size = 8, color = c2, family = \"ubuntu\", margin = margin(t = 20)),\n    panel.grid.major = element_line(color = c3, linetype = 2, linewidth = .17),\n    panel.grid.minor.x = element_line(color = c3, linetype = 3, linewidth = .1),\n    panel.spacing.x = unit(3, \"line\"),\n    axis.ticks = element_line(color = c3),\n    axis.ticks.length = unit(2, \"mm\"),\n    axis.text.x = element_text(\n      family = \"bebas\", color = c2, size = 22, hjust = 0,\n      margin = margin(t = 5)),\n    axis.text.y = element_text(\n      family = \"jet\", color = c2, vjust = 0, margin = margin(r = 5),\n      size = 8),\n    \n    axis.title.y = element_markdown(\n      color = c3, family = \"ubuntu\", size = 15, angle = 90, \n      margin = margin(r = 10)),\n    \n    strip.text = element_text(\n      family = \"ubuntu\", color = c2, size = 20, margin = margin(b = 10)),\n    legend.position = \"none\"\n  )\n\n# guardo\nggsave(\n  plot = g,\n  filename = \"2024/s18/viz.png\",\n  width = 30,\n  height = 18,\n  units = \"cm\")\n\n# abro\nbrowseURL(\"2024/s18/viz.png\")\n```\n:::\n\n\n\n\n# Figura\n\n![](https://raw.githubusercontent.com/vhgauto/tidytuesday/refs/heads/main/2024/s18/viz.png)\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}