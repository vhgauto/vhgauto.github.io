{
  "hash": "8397d4607205d9d3667c16ce88a91ba2",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Semana 19\"\nsubtitle: \"Figura semana 19\"\nauthor: Víctor Gauto\ndate: \"2023-05-14\"\neditor_options:\n  chunk_output_type: console\ncategories: [geom_hline, geom_density_ridges, geom_text]\nimage: https://raw.githubusercontent.com/vhgauto/tidytuesday/refs/heads/main/2023/semana_19/viz.png\nexecute:\n  eval: false\n  echo: true\ncode-fold: true\n---\n\n\n\n\n\n# Script\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# paquetes ----------------------------------------------------------------\n\nlibrary(tidyverse)\nlibrary(ggtext)\nlibrary(glue)\nlibrary(showtext)\nlibrary(ggridges)\n\n# fuente ------------------------------------------------------------------\n\n# colores\n# paleta 'Homer1' de MetBrewer\nc1 <- \"#c3f4f6\"\nc2 <- \"#6ad5e8\"\nc3 <- \"#df9ed4\"\nc4 <- \"#16317d\"\nc5 <- \"#a62f00\"\n\n# eje vertical, años\nfont_add_google(name = \"Bebas Neue\", family = \"bebas\")\n# texto gral\nfont_add_google(name = \"Carlito\", family = \"carlito\", db_cache = FALSE)\n# eje horizontal\nfont_add_google(name = \"Inconsolata\", family = \"inconsolata\")\n# título\nfont_add_google(name = \"Noto Serif\", family = \"noto\")\n\nshowtext_auto()\nshowtext_opts(dpi = 300)\n\n# íconos\nfont_add(\"fa-brands\", \"icon/Font Awesome 6 Brands-Regular-400.otf\")\n\nshowtext_auto()\nshowtext_opts(dpi = 300)\n\n# caption\nfuente <- glue(\"Datos: <span style='color:{c3};'><span style='font-family:mono;'>{{<b>tidytuesdayR</b>}}</span> semana 19</span>\")\nautor <- glue(\"Autor: <span style='color:{c3};'>**Víctor Gauto**</span>\")\nicon_twitter <- glue(\"<span style='font-family:fa-brands;'>&#xf099;</span>\")\nicon_github <- glue(\"<span style='font-family:fa-brands;'>&#xf09b;</span>\")\nusuario <- glue(\"<span style='color:{c3};'>**vhgauto**</span>\")\nsep <- glue(\"**|**\")\n\nmi_caption <- glue(\"{fuente} {sep} {autor} {sep} {icon_github} {icon_twitter} {usuario}\")\n\n# datos -------------------------------------------------------------------\n\nbrowseURL(\"https://github.com/rfordatascience/tidytuesday/blob/master/data/2023/2023-05-09/readme.md\")\n\nchildcare_costs <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-05-09/childcare_costs.csv')\ncounties <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-05-09/counties.csv')\n\n# acomodo los datos\n# selecciono 'infant'\ndatos <- childcare_costs |> \n  select(study_year, ends_with(\"infant\"), mhi_2018) |> \n  pivot_longer(cols = ends_with(\"infant\"),\n               values_to = \"price\",\n               names_to = \"group\") |> \n  separate(group, into = c(\"base\", \"age\"), sep = \"_\") |> \n  mutate(study_year = factor(study_year)) |> \n  select(-age) |> \n  drop_na(price)\n\n# valores de mediana, por 'base' y 'study_year'\nm <- datos |> \n  group_by(study_year, base) |> \n  summarise(price = median(price, na.rm = TRUE)) |> \n  ungroup() |> \n  mutate(label = format(round(price, 1), nsmall = 1)) |> \n  mutate(label = str_replace_all(label, \"\\.\", \",\"))\n\n# figura ------------------------------------------------------------------\n\ng <- ggplot() +\n  # horizontales en gris\n  geom_hline(yintercept = factor(2008:2018), color = c2, linewidth = .5) +\n  # densidad, con fill\n  geom_density_ridges(\n    data = datos, \n    aes(x = price, y = study_year, color = base),\n    alpha = 0, panel_scaling = FALSE, scale = 1, show.legend = FALSE, \n    size = 1) +\n  # punto de mediana\n  geom_text(\n    data = m, \n    aes(x = price, y = study_year, label = \"|\"),\n    size = 3, nudge_y = .05, show.legend = FALSE, color = c2) +\n  # valor de mediana\n  geom_text(\n    data = m, \n    aes(x = price, y = study_year, label = label, color = base),\n    size = 4, nudge_y = .14, family = \"inconsolata\", show.legend = FALSE,\n    fontface = \"bold\") +\n  # manual\n  scale_x_continuous(breaks = seq(0, 500, 100)) +\n  scale_color_manual(values = c(c3, c4)) +\n  labs(x = \"Costo semanal, de tiempo completo (USD, 2018)\", y = NULL,\n       title = \"¿Cuánto cuesta cuidar un bebé?\",\n       subtitle = glue(\n         \"Entre **2008**-**2018** el costo asociado al cuidado de bebés (entre recién \n       nacido y los 23 meses) fue aumentando poco a poco en **EE.UU**. Si sucede \n       en la <span style='color:{c3};'>**casa**</span>, los precios son superiores a \n       si los mandás a una <span style='color:{c4};'>**guardería**</span>. \n       Se indican los valores de las medianas en cada año.\"),\n       caption = mi_caption) +\n  coord_cartesian(expand = FALSE, xlim = c(0, 500), ylim = c(.95, 11.5),\n                  clip = \"off\") +\n  theme_minimal() +\n  theme(\n    aspect.ratio = 1.5,\n    plot.background = element_rect(\n      fill = c1, color = c2, linewidth = 3),\n    plot.title = element_markdown(\n      size = 52, family = \"noto\", color = c4),\n    plot.title.position = \"plot\",\n    plot.subtitle = element_textbox_simple(\n      size = 20, family = \"carlito\", color = c5, margin = margin(25, 0, 36, 0)),\n    plot.caption = element_markdown(\n      size = 15, color = c4, family = \"carlito\", hjust = .4, \n      margin = margin(15, 0, 3, 0)),\n    plot.margin = margin(15, 32, 0, 32),\n    panel.background = element_blank(),\n    panel.grid = element_blank(),\n    panel.grid.major.x = element_line(color = c2, linewidth = .5, linetype = 3),\n    axis.text.y = element_text(\n      size = 40, vjust = 0, family = \"bebas\", color = c5),\n    axis.text.x = element_text(\n      size = 25, family = \"inconsolata\", color = c5),\n    axis.title.x = element_markdown(\n      size = 20, family = \"carlito\", color = c5, margin = margin(15, 0, 0, 0))\n  )\n\n# guardo\nggsave(filename = \"2023/semana_19/viz.png\",\n       width = 30,\n       height = 48,\n       units = \"cm\",\n       dpi = 300)\n\n# abro\nbrowseURL(\"2023/semana_19/viz.png\")\n```\n:::\n\n\n\n\n# Figura\n\n![](https://raw.githubusercontent.com/vhgauto/tidytuesday/refs/heads/main/2023/semana_19/viz.png)\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}