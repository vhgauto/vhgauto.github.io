{
  "hash": "42c18d965d8631f8b17aa4c4cc6f2676",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Semana 18\"\nsubtitle: \"Figura semana 18\"\nauthor: Víctor Gauto\ndate: \"2023-05-07\"\neditor_options:\n  chunk_output_type: console\ncategories: [geom_segment, geom_point, geom_from_path]\nimage: https://raw.githubusercontent.com/vhgauto/tidytuesday/refs/heads/main/2023/semana_18/viz.png\nexecute:\n  eval: false\n  echo: true\ncode-fold: true\n---\n\n\n\n\nRoedores de Arizona.\n\n# Script\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# paquetes ----------------------------------------------------------------\n\nlibrary(tidyverse)\nlibrary(ggh4x)\nlibrary(ggtext)\nlibrary(showtext)\nlibrary(glue)\nlibrary(ggpath)\n\n# fuente ------------------------------------------------------------------\n\n# colores\n# paleta 'Bwenedictus' de MetBrewer\nc1 <- \"#fcebf0\"\nc2 <- \"#f9b4c9\"\nc3 <- \"#b93961\"\nc4 <- \"#9a153d\"\nc5 <- \"#1a318b\"\nc6 <- \"#6996e3\"\n\nfont_add_google(name = \"Share Tech Mono\", family = \"share\") # números\nfont_add_google(name = \"Anek Tamil\", family = \"anek\", db_cache = FALSE) # texto gral\nfont_add_google(name = \"Almendra\", family = \"almendra\", db_cache = FALSE) # título\n\nshowtext_auto()\nshowtext_opts(dpi = 300)\n\n# íconos\nfont_add(\"fa-reg\", \"icon/Font Awesome 6 Free-Regular-400.otf\")\nfont_add(\"fa-brands\", \"icon/Font Awesome 6 Brands-Regular-400.otf\")\nfont_add(\"fa-solid\", \"icon/Font Awesome 6 Free-Solid-900.otf\")\n\nshowtext_auto()\nshowtext_opts(dpi = 300)\n\n# caption\nfuente <- glue(\"Datos: <span style='color:{c3};'><span style='font-family:mono;'>{{<b>tidytuesdayR</b>}}</span> semana 18</span>\")\nautor <- glue(\"Autor: <span style='color:{c3};'>**Víctor Gauto**</span>\")\nicon_twitter <- glue(\"<span style='font-family:fa-brands;'>&#xf099;</span>\")\nicon_github <- glue(\"<span style='font-family:fa-brands;'>&#xf09b;</span>\")\nusuario <- glue(\"<span style='color:{c3};'>**vhgauto**</span>\")\nsep <- glue(\"**|**\")\n\nmi_caption <- glue(\"{fuente} {sep} {autor} {sep} {icon_github} {icon_twitter} {usuario}\")\n\n# datos -------------------------------------------------------------------\n\nbrowseURL(\"https://github.com/rfordatascience/tidytuesday/blob/master/data/2023/2023-05-02/readme.md\")\n\nspecies <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-05-02/species.csv')\n\n# arreglo datos\ndatos <- species |> \n  # selecciono variables de interés\n  select(nombre = commonname, ends_with(\"wgt\"), -juvwgt) |> \n  # renombro removiendo 'wgt'\n  rename_with(~ str_remove(.x, \"wgt\")) |> \n  # divido en RATAS y RATONES\n  mutate(animal = case_when(\n    str_detect(nombre, \"rat\") ~ \"Rata\",\n    str_detect(nombre, \"ouse\") ~ \"Ratón\")) |> \n  # de los nombres de los animales, remuevo 'mouse' y 'rat'\n  mutate(nombre = str_remove(nombre, \"mouse|Mouse|rat\")) |>\n  mutate(nombre = str_trim(nombre)) |> \n  # acomodo el texto\n  mutate(nombre = if_else(animal == \"Rata\", str_wrap(nombre, width = 12), nombre)) |> \n  # ordeno los nombres de acuerdo al peso promedio\n  mutate(nombre = fct_reorder(nombre, mean))\n\n# imágenes .png de rata y ratón\nbrowseURL(\"https://emojipedia.org/openmoji/\")\n\nlista_i <- list.files(\"2023/semana_18/\",\n                      pattern = \"^i_\",\n                      full.names = TRUE)\n\nroedor <- tibble(min = c(Inf, Inf),\n                 nombre = c(-Inf, -Inf),\n                 animal = c(\"Rata\", \"Ratón\"),\n                 path = lista_i)\n\n# figura ------------------------------------------------------------------\n\n# escalas individuales del eje horizontal\nescalas <- list(\n  # rata\n  scale_x_continuous(breaks = seq(0, 300, 50), limits = c(0, 300)),\n  # ratón\n  scale_x_continuous(breaks = seq(0, 100, 25), limits = c(0, 100)))\n\n# separador de las palabras del título\n# sin este separador queda todo muy pegado, con poco espacio\ns <- glue(\"<span style='color:{c1}'>..</span>\")\n\n# figura\nggplot(data = datos, aes(x = min, xend = max, y = nombre, yend = nombre)) +\n  # segmento que une max y min\n  geom_segment(color = c2, linewidth = 2, lineend = \"round\") +\n  # min\n  geom_point(aes(x = min), color = c6, size = 4) +\n  # max\n  geom_point(aes(x = max), color = c5, size = 4) +\n  # promedio\n  geom_point(\n    aes(x = mean), shape = \"|\", size = 4, color = c3) +\n  # emoji de rata y ratón\n  geom_from_path(data = roedor, aes(x = min, y = nombre, path = path),\n                 inherit.aes = FALSE, width = 0.3, hjust = 1.25, vjust = .4) +\n  # facetas\n  facet_wrap(~ animal, scales = \"free\") +\n  facetted_pos_scales(x = escalas) +\n  # títulos\n  labs(x = \"Peso (g)\", y = NULL,\n       title = glue(\"DE{s}RATAS{s}Y{s}RATONES\"),\n       subtitle = glue(\n         \"Tomando datos de **roedores** que habitan el desierto de \n         Arizona (EEUU), se muestran los valores de <span style='color:{c6};'>**peso mínimo**</span> y\n         <span style='color:{c5};'>**peso máximo**</span>, para cada especie. Las líneas verticales indican\n         pesos promedio. Se clasificaron los datos entre **ratas** y\n         **ratones**.\"),\n       caption = mi_caption) +\n  # tema\n  theme_minimal() +\n  theme(\n    aspect.ratio = 2,\n    plot.background = element_rect(fill = c1, color = c2, linewidth = 2),\n    plot.title = element_markdown(\n      family = \"almendra\", size = 60, color = c4, hjust = .5),\n    plot.title.position = \"plot\",\n    plot.caption = element_markdown(\n      color = c4, hjust = .4, family = \"anek\", size = 11, \n      margin = margin(20, 0, 0, 0)),\n    plot.subtitle = element_textbox_simple(\n      family = \"anek\", size = 15, color = c3, margin = margin(0, 0, 10, 0)), \n    plot.margin = margin(12, 10, 12, 10),\n    panel.grid.minor = element_blank(),\n    panel.grid.major.y = element_blank(),\n    panel.grid.major.x = element_line(color = c2, linewidth = .2),\n    panel.spacing.x = unit(2, \"line\"),\n    axis.text.x = element_text(family = \"share\", size = 17, color = c3),\n    axis.text.y = element_text(family = \"anek\", color = c4, size = 13),\n    axis.title.x = element_markdown(family = \"anek\", size = 23, color = c4),\n    strip.text = element_markdown(color = c4, family = \"anek\", size = 25)\n  )\n\n# guardo\nggsave(\n    filename = \"2023/semana_18/viz.png\",\n    width = 30,\n    height = 28.5,\n    units = \"cm\",\n    dpi = 300)\n\n# abro\nbrowseURL(\"2023/semana_18/viz.png\")\n```\n:::\n\n\n\n\n# Figura\n\n![](https://raw.githubusercontent.com/vhgauto/tidytuesday/refs/heads/main/2023/semana_18/viz.png)\n\n\n",
    "supporting": [
      "semana_18_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}