{
  "hash": "90ff97e5162789f84aaa09532042d512",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Semana 28\"\nsubtitle: \"Figura semana 28\"\nauthor: Víctor Gauto\ndate: \"2023-07-16\"\neditor_options:\n  chunk_output_type: console\ncategories: [geom_raster, geom_hline, geom_text, geom_line, geom_richtext]\nimage: https://raw.githubusercontent.com/vhgauto/tidytuesday/refs/heads/main/2023/semana_28/viz.png\nexecute:\n  eval: false\n  echo: true\ncode-fold: true\n---\n\n\n\n\n\n# Script\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# paquetes ----------------------------------------------------------------\n\nlibrary(tidyverse)\nlibrary(glue)\nlibrary(ggtext)\nlibrary(showtext)\n\n# fuentes -----------------------------------------------------------------\n\n# colores\nc1 <- \"grey30\"\nc2 <- \"grey70\"\nc3 <- \"white\"\n\n# texto gral\nfont_add_google(name = \"Ubuntu\", family = \"ubuntu\")\n# anomalías de temperatura\nfont_add_google(name = \"Inconsolata\", family = \"inconsolata\")\n# años\nfont_add_google(name = \"Bebas Neue\", family = \"bebas\")\n# título\nfont_add_google(name = \"Gloock\", family = \"gloock\", db_cache = FALSE)\n\n# íconos\nfont_add(\"fa-brands\", \"icon/Font Awesome 6 Brands-Regular-400.otf\")\nfont_add(\"fa-solids\", \"icon/Font Awesome 6 Free-Solid-900.otf\")\n\nshowtext_auto()\nshowtext_opts(dpi = 300)\n\n# caption\nfuente <- glue(\"Datos: <span style='color:{c3};'><span style='font-family:mono;'>{{<b>tidytuesdayR</b>}}</span> semana 28, GISS Surface Temperature Analysis</span>\")\nautor <- glue(\"Autor: <span style='color:{c3};'>**Víctor Gauto**</span>\")\nicon_twitter <- glue(\"<span style='font-family:fa-brands;'>&#xf099;</span>\")\nicon_github <- glue(\"<span style='font-family:fa-brands;'>&#xf09b;</span>\")\nusuario <- glue(\"<span style='color:{c3};'>**vhgauto**</span>\")\nsep <- glue(\"**|**\")\n\nmi_caption <- glue(\"{fuente} {sep} {autor} {sep} {icon_github} {icon_twitter} {usuario}\")\n\n# datos -------------------------------------------------------------------\n\nbrowseURL(\"https://github.com/rfordatascience/tidytuesday/blob/master/data/2023/2023-07-11/readme.md\")\n\nglobal_temps <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-07-11/global_temps.csv')\n\n# elijo las anomalía anual (j_d)\nd <- global_temps |> \n  janitor::clean_names() |> \n  select(year, j_d) |> \n  drop_na()\n\n# figura ------------------------------------------------------------------\n\n# valores de anomalía de temperatura formateados\nanom <- tibble(j_d = seq(-.50, 1.25, .50)) |> \n  mutate(label = gt::vec_fmt_number(j_d, decimals = 1, pattern = \"{x}°C\", sep_mark = \".\", dec_mark = \",\"))\n\n# título de la figura\ntitulo <- tibble(\n  x = 1890,\n  y = 1,\n  label = \"Anomalía de temperatura<br>superficial global\"\n)\n\n# subtítulo de la figura\nsubtitulo <- tibble(\n  x = 1890,\n  y = .85,\n  label = \"Las desviaciones se consideran a<br>partir de la media entre 1951-1980.\"\n)\n\n# figura\ng <- ggplot(data = d, aes(x = year, y = j_d)) +\n  # fondo de anomalías\n  geom_raster(aes(y = 1, fill = j_d)) +\n  geom_raster(aes(y = 0, fill = j_d)) +\n  geom_raster(aes(y = -1, fill = j_d)) +\n  # horizontales de anomalía de temperatura\n  geom_hline(yintercept = anom$j_d, color = c2, linetype = 3, linewidth = .3) +\n  # etiquetas de anomalías de temperatura\n  geom_text(\n    data = anom, aes(x = 1880, y = j_d, label = label), inherit.aes = FALSE,\n    angle = 0, hjust = 0, vjust = 0, color = \"gold\", family = \"inconsolata\", size = 7) +\n  # anomalías de temperatura\n  geom_line(linewidth = 1.5, color = \"white\", lineend = \"round\") +\n  geom_line(linewidth = 1, color = c2, lineend = \"round\") +\n  geom_line(linewidth = .25, color = \"black\", lineend = \"round\") +\n  # título\n  geom_richtext(\n    data = titulo, aes(x = x, y = y, label = label), \n    family = \"gloock\", size = 12, hjust = 0, vjust = .5, fill = alpha(c1, .6),\n    label.color = NA, color = c3) +\n  # subtítulo\n  geom_richtext(\n    data = subtitulo, aes(x = x, y = y, label = label), \n    family = \"ubuntu\", size = 7, hjust = 0, vjust = .5, fill = alpha(c1, .6),\n    label.color = NA, color = c3) +\n  # maual\n  scale_fill_viridis_c(option = \"inferno\") +\n  # ejes\n  scale_x_continuous(breaks = seq(1800, 2020, 20)) +\n  labs(x = NULL, y = NULL, caption = mi_caption) +\n  coord_cartesian(expand = FALSE, ylim = c(-.55, 1.1), clip = \"on\") +\n  theme_void() +\n  theme(\n    aspect.ratio = 1,\n    plot.margin = margin(67, 67, 15, 67),\n    plot.background = element_rect(fill = c1, color = c2, linewidth = 3),\n    plot.caption.position = \"plot\",\n    plot.caption = element_markdown(\n      family = \"ubuntu\", color = c2, size = 11, margin = margin(15, 0, 0, 0)),\n    axis.text.x = element_text(\n      color = \"gold\", family = \"bebas\", hjust = 0, size = 30),\n    axis.ticks.x = element_line(color = \"black\", linewidth = .75),\n    axis.ticks.length.x = unit(.2, \"line\"),\n    legend.position = \"none\",\n    panel.grid = element_blank()\n  )\n\n# guardo\nggsave(\n    plot = g,\n    filename = \"2023/semana_28/viz.png\",\n    width = 30,\n    height = 30,\n    units = \"cm\",\n    dpi = 300\n  )\n\n# abro\nbrowseURL(\"2023/semana_28/viz.png\")\n```\n:::\n\n\n\n\n# Figura\n\n![](https://raw.githubusercontent.com/vhgauto/tidytuesday/refs/heads/main/2023/semana_28/viz.png)\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}