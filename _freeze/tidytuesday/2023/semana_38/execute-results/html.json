{
  "hash": "02326e24a8b7c54dd5d22ed21eb95c70",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Semana 38\"\nsubtitle: \"Figura semana 38\"\nauthor: Víctor Gauto\ndate: \"2023-09-24\"\neditor_options:\n  chunk_output_type: console\ncategories: [geom_edge_arc, geom_node_point, geom_node_text]\nimage: https://raw.githubusercontent.com/vhgauto/tidytuesday/refs/heads/main/2023/semana_38/viz.png\nexecute:\n  eval: false\n  echo: true\ncode-fold: true\n---\n\n\n\n\nPaquetes con nombre 'gg' y que dependen de ggplot2.\n\n# Script\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# paquetes ----------------------------------------------------------------\n\nlibrary(tidyverse)\nlibrary(ggraph)\nlibrary(showtext)\nlibrary(glue)\nlibrary(ggtext)\n\n# fuente ------------------------------------------------------------------\n\n# colores\nc1 <- \"grey95\"\nc2 <- \"gold\"\nc3 <- \"grey30\"\nc4 <- \"#C159A0\"\n\n# caption\nfont_add_google(name = \"Ubuntu\", family = \"ubuntu\")\n# paquetes\nfont_add_google(name = \"Victor Mono\", family = \"victor\", db_cache = FALSE)\n\n# íconos\nfont_add(\"fa-brands\", \"icon/Font Awesome 6 Brands-Regular-400.otf\")\nfont_add(\"fa-solids\", \"icon/Font Awesome 6 Free-Solid-900.otf\")\n\nshowtext_auto()\nshowtext_opts(dpi = 300)\n\n# caption\nfuente <- glue(\"Datos: <span style='color:{c3};'><span style='font-family:victor;'>{{<b>tidytuesdayR</b>}}</span> semana 38.  CRAN collaboration graph, **David Schoch**</span>\")\nautor <- glue(\"Autor: <span style='color:{c3};'>**Víctor Gauto**</span>\")\nicon_twitter <- glue(\"<span style='font-family:fa-brands;'>&#xf099;</span>\")\nicon_github <- glue(\"<span style='font-family:fa-brands;'>&#xf09b;</span>\")\nusuario <- glue(\"<span style='color:{c3};'>**vhgauto**</span>\")\nsep <- glue(\"**|**\")\n\nmi_caption <- glue(\"{fuente}<br>{autor} {sep} {icon_github} {icon_twitter} {usuario}\")\n\n# datos -------------------------------------------------------------------\n\nbrowseURL(\"https://github.com/rfordatascience/tidytuesday/blob/master/data/2023/2023-09-19/readme.md\")\n\ncran_20230905 <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-09-19/cran_20230905.csv')\n\n# me interesa ver los paquetes que empiezan con 'gg', como un grafo\n\n# paleta de colores alrededor de 'ggplot2'\nf_paleta <- colorRampPalette(\n  c(\"#475CA7\", \"#4C6CB2\", \"#4CC8F1\", \"#75CAC2\", \"#76C26F\", \"#6FBF50\",\n    \"#7FC24E\", \"#B8D442\", \"gold\", \"#F68235\", \"#EE3738\", \"#EE3356\",\n    \"#ED3894\", \"#C159A0\"))\n\n# elijo los paquetes que empiezan con 'gg' y que tienen 'ggplot2' como\n# dependencia\nd <- cran_20230905 |> \n  select(paq = Package, dep = Depends) |> \n  separate_longer_delim(dep, \",\") |> \n  mutate(dep = str_trim(dep)) |> \n  filter(str_detect(paq, \"^gg\")) |> \n  drop_na(dep) |> \n  filter(str_detect(dep, \"ggplot2\")) |> \n  mutate(dep = \"ggplot2\") |> \n  mutate(co = f_paleta(66))\n\n# ángulos de texto de los paquetes alrededor del grafo\ns1 <- seq(90, 0, length.out = 16)\ns2 <- seq(360, 270, length.out = 17)\ns3 <- seq(-270, -360, length.out = 17)\ns4 <- seq(0, -90, length.out = 17)\n\n# agrego hjust, vjust, size y colores\n# en el caso de 'ggplot2', tiene valores diferentes\nd_vertices <- d |> \n  distinct(paq) |> \n  add_row(paq = \"ggplot2\") |> \n  # mutate(hjust = case_when(\n  #   row_number() <= 33 ~ -.05, \n  #   row_number() > 33 ~ 1.05,\n  #   .default = .5)) |> \n  mutate(hjust = if_else(row_number() <= 33, -.075, 1.075)) |> \n  mutate(angle = c(s1, s2, s3, s4)) |> \n  mutate(vjust = .5) |> \n  mutate(size = 7) |> \n  mutate(angle = if_else(paq == \"ggplot2\", 0, angle)) |> \n  mutate(hjust = if_else(paq == \"ggplot2\", .5, hjust)) |> \n  mutate(vjust = if_else(paq == \"ggplot2\", -5.5, vjust)) |>\n  mutate(size = if_else(paq == \"ggplot2\", 20, size)) |> \n  mutate(co = f_paleta(67))\n\n# creo el grafo\ngraph <- igraph::graph_from_data_frame(d, vertices = d_vertices)\n\n# figura ------------------------------------------------------------------\n\ng <- ggraph(graph, layout = 'linear', circular = TRUE) + \n  # flecha apuntando a 'ggplot2'\n  annotate(\n    geom = \"segment\", x = -.047, xend = -.047, y = .99, yend = 1.75, \n    color = c4, arrow = arrow(angle = 10, type = \"closed\"), linewidth = 2) +\n  # arcos que unen 'paq' con 'ggplot2'\n  geom_edge_arc(\n    aes(colour = I(co)), edge_width = 2, linemitre = 1, lineend = \"round\",\n    show.legend = FALSE) + \n  # puntos de color y blancos\n  geom_node_point(aes(colour = I(co)), size = 2) +\n  geom_node_point(color = c1, size = .25) +\n  # texto 'paq'\n  geom_node_text(\n    aes(\n      label = name, angle = angle, hjust = hjust, vjust = vjust, size = size,\n      colour = I(co)),\n    show.legend = FALSE, fontface = \"bold\", family = \"victor\") +\n  coord_fixed(clip = \"off\") +\n  scale_size_identity() +\n  labs(caption = mi_caption) +\n  theme_void() +\n  theme(\n    plot.margin = margin(90, 117.9, 5, 117.9),\n    plot.background = element_rect(fill = c1, color = c4, linewidth = 3),\n    plot.caption = element_markdown(\n      hjust = 1, color = c4, margin = margin(90, 0, 0, 0), size = 9,\n      family = \"ubuntu\"),\n    plot.caption.position = \"plot\"\n  )\n\n# guardo\nggsave(\n  plot = g,\n  filename = \"2023/semana_38/viz.png\",\n  width = 30,\n  height = 37,\n  units = \"cm\")\n\n# abro\nbrowseURL(\"2023/semana_38/viz.png\")\n```\n:::\n\n\n\n\n# Figura\n\n![](https://raw.githubusercontent.com/vhgauto/tidytuesday/refs/heads/main/2023/semana_38/viz.png)\n\n\n",
    "supporting": [
      "semana_38_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}