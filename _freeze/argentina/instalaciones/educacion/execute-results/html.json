{
  "hash": "5a439e2f85178d2a3039b92aa92bc39e",
  "result": {
    "engine": "knitr",
    "markdown": "---\nformat:\n  html:\n    code-fold: show\n    code-summary: \"Ocultar código\"\n    code-line-numbers: false\n    code-annotations: false\n    code-link: true\n    code-tools:\n        source: true\n        toggle: true\n        caption: \"Código\"\n    code-overflow: scroll\n    page-layout: full\neditor_options:\n  chunk_output_type: console\ncategories: [\"geom_sf\", \"geom_point\", \"geom_text\"]\nexecute:\n  eval: false\n  echo: true\n  warning: false\ntitle: \"🏫 Ciencia y educación\"\ndate: 2024-08-03\nauthor: Víctor Gauto\n---\n\n\n\n\nMapa de instituciones de ciencia y educación.\n\n![Institutos dedicados al desarrollo de la ciencia y la educación, destacando la Universidad Tecnológica Nacional.](educacion.png)\n\n## Paquetes\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(terra)\nlibrary(glue)\nlibrary(tidyterra)\nlibrary(ggfx)\nlibrary(showtext)\nlibrary(ggtext)\nlibrary(tidyverse)\n```\n:::\n\n\n\n\n## Estilos\n\nColores aleatorios a partir de una gama de rosados.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nc1 <- \"lightblue\"\nc2 <- \"orange\"\nc3 <- \"white\"\nc4 <- \"grey5\"\nc5 <- \"grey30\"\n```\n:::\n\n\n\n\nFuentes: Ubuntu, JetBrains Mono y fontawesome.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfont_add(\n  family = \"ubuntu\",\n  regular = \"././fuente/Ubuntu-Regular.ttf\",\n  bold = \"././fuente/Ubuntu-Bold.ttf\",\n  italic = \"././fuente/Ubuntu-Italic.ttf\"\n)\n\nfont_add(\n  family = \"jet\",\n  regular = \"././fuente/JetBrainsMonoNLNerdFontMono-Regular.ttf\"\n)\n\nshowtext_auto()\nshowtext_opts(dpi = 300)\n```\n:::\n\n\n\n\n## Epígrafe\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfuente <- glue(\n  \"<b>Datos:</b> <span style='color:{c3};'>IGN</span>\")\nautor <- glue(\"<span style='color:{c3};'>Víctor Gauto</span>\")\nicon_twitter <- glue(\"<span style='font-family:jet;'>&#xeb72;</span>\")\nicon_instagram <- glue(\"<span style='font-family:jet;'>&#xf16d;</span>\")\nicon_github <- glue(\"<span style='font-family:jet;'>&#xf09b;</span>\")\nicon_mastodon <- glue(\"<span style='font-family:jet;'>&#xf0ad1;</span>\")\nicon_bluesky <- glue(\"<span style='font-family:jet;'>&#xe28e;</span>\")\nusuario <- glue(\"<span style='color:{c3};'>vhgauto</span>\")\nsep <- glue(\"**|**\")\n\nmi_caption <- glue(\n  \"{fuente} {sep} {autor} {sep} <b>{icon_github} {icon_twitter} \",\n  \"{icon_instagram} {icon_mastodon} {icon_bluesky}</b> {usuario}\"\n)\n```\n:::\n\n\n\n\n## Datos\n\nObtengo los datos del [Instituto Geográfico Nacional](https://www.ign.gob.ar/NuestrasActividades/InformacionGeoespacial/CapasSIG), en la categoría Ciencia y educación, Universidad.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nu <- vect(\"argentina/vectores/puntos_de_ciencia_y_educacion_020602.json\") |>\n  project(\"EPSG:5346\")\n```\n:::\n\n\n\n\nLeo los datos de las provincias y departamentos de Argentina.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndptos <- vect(\"argentina/vectores/dptos_continental.gpkg\")\npcias <- vect(\"argentina/vectores/pcias_continental.gpkg\")\n```\n:::\n\n\n\n\nMe interesa la **Universidad Tecnológica Nacional** (UTN).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- u |>\n  mutate(\n    es_utn = str_detect(gna, \"Universidad Tecnológica Nacional\")\n  ) |>\n  mutate(\n    es_utn = if_else(\n      is.na(es_utn),\n      FALSE,\n      es_utn\n    )\n  )\n```\n:::\n\n\n\n\nDivido los datos según si son de la UTN o del resto de instituciones.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd_utn <- filter(d, es_utn)\nd_otra <- filter(d, !es_utn)\n```\n:::\n\n\n\n\nCantidad total de UTN.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn_u <- format(nrow(u), big.mark = \".\", decimal.mark = \",\")\n```\n:::\n\n\n\n\n## Figura\n\nDescripción y subtítulo del mapa.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nleyenda_tbl <- tibble(\n  x = 5.1e6,\n  y = c(7.5e6, 7.38e6),\n  label = c(\n    \"Universidad Tecnológica\\nNacional (UTN)\",\n    \"Otras instituciones\\neducativas\")\n) |>\n  mutate(x_label = x+.5e5)\n\nmi_subtitle <- glue(\n  \"En <b>Argentina</b> hay {n_u} <b style='color:{c1}'>instituciones</b><br>\",\n  \"dedicadas al desarrollo científico y<br>\",\n  \"educativo. Del total, {nrow(d_utn)} son facultades<br>\",\n  \"regionales de la \",\n  \"<b style='color:{c2}'>Universidad<br>Tecnológica Nacional</b>.\"\n)\n```\n:::\n\n\n\n\nFigura.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng <- ggplot() +\n  # departamentos\n  geom_sf(data = dptos, fill = c4, color = c5, linewidth = .1) +\n  # provincias\n  geom_sf(data = pcias, fill = NA, color = c5, linewidth = .5) +\n  # otras universidades\n  with_blur(\n    geom_sf(\n      data = d_otra, color = c1, size = 4, shape = 20),\n    sigma = 8\n  ) +\n  geom_sf(\n    data = d_otra, color = c1, size = .5, shape = 20) +\n  # Universidad Tecnológica Nacional\n  with_blur(\n    geom_sf(\n      data = d_utn, color = c2, size = 4, shape = 20),\n    sigma = 8\n  ) +\n  geom_sf(\n    data = d_utn, color = c2, size = .5, shape = 20) +\n  # leyenda\n  with_blur(\n    geom_point(\n      data = leyenda_tbl, aes(x, y), color = c(c2, c1), size = 7),\n    sigma = 8\n  ) +\n  geom_point(\n    data = leyenda_tbl, aes(x, y), color = c(c2, c1), size = 2\n  ) +\n  geom_text(\n    data = leyenda_tbl, aes(x_label, y, label = label), family = \"ubuntu\",\n    color = c3, hjust = 0, size = 7, lineheight = unit(.8, \"line\")\n  ) +\n  annotate(\n    geom = \"richtext\", x = 4.7e6, y = 5e6, label = mi_subtitle, size = 8,\n    family = \"ubuntu\", color = c3, fill = NA, label.color = NA, hjust = 0,\n    lineheight = 1.2\n  ) +\n  coord_sf(clip = \"off\") +\n  labs(caption = mi_caption) +\n  theme_void() +\n  theme(\n    plot.margin = margin(r = 160, t = .6, b = .6),\n    plot.background = element_rect(fill = c4, color = c3, linewidth = 3),\n    plot.caption.position = \"plot\",\n    plot.caption = element_markdown(\n      family = \"ubuntu\", color = c1, size = 20, hjust = .5,\n      margin = margin(b = 10, r = -160)\n    )\n  )\n```\n:::\n\n\n\n\nGuardo.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggsave(\n  plot = g,\n  filename = \"argentina/instalaciones/educacion.png\",\n  width = 30,\n  height = 54,\n  units = \"cm\"\n)\n```\n:::\n",
    "supporting": [
      "educacion_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}